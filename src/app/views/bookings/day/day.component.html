<html lang='en'>
  <head>
    <meta charset='utf-8' />
  </head>
  <body>
    <div class="animated fadeIn">
      <div class="card">
        <div class="card-header">
          <i class="icon-calendar"></i> Calendar
          <div class="float-right">
            <button type="button" class="round-button round-button-circle" data-toggle="modal" (click)="largeModal.show()"> + </button>
          </div>
        </div>
        <div class="card-body">
          <div class='app'>
            <full-calendar
              #calendar
              defaultView="dayGridMonth"
              [header]="{
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,resourceTimelineDay,resourceTimelineWeek,listWeek'
              }"
              [plugins]     ="calendarPlugins"
              [weekends]    ="calendarWeekends"
              [events]      ="calendarEvents"
              (dateClick)   ="handleDateClick($event)"
              schedulerLicenseKey="GPL-My-Project-Is-Open-Source"
              [resourceColumns]  ="resourcecolumns"
              [resources]   ="resourcelist"
              selectable    ="true"
              selectHelper  ="true"
              navLinks      ="true"
              editable      ="true"
              (clickButton) ="clickButton($event.detail)"
              (eventClick)  ="eventClick($event)" 
              (clickButton) ="clickButton($event.detail)"
              navLinks      ="true"
              eventColor    ='#378006'
            ></full-calendar>
            <div *ngIf="is_loading">
              <div colspan="6" class="text-center padding-top">
                <div>
                  <div class="lds-spinner margin-top">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                  </div>
                </div>
              </div>
            </div> 
            <!--Next-->      
            <!--Detail Model-->
            <div bsModal #detailModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-primary" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h4 class="modal-title">Details of Bookings</h4>
                    <button type="button" class="close" (click)="detailModal.hide()" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>                   
                  </div>
                  <div class="modal-body">
                    <!--Form starts here-->
                    <div class="card">
                      <div class="card-header">
                        <strong>Details</strong> bookings
                      </div>
                      <div class="card-body">                  
                          <div class="row">
                            <div class="form-group col-sm-6">
                             <label  for="text-input">Employee Name:</label>            
                             <input type="text" class="form-control" #employee_name="ngModel" [(ngModel)]="selected_employee"
                               [ngModelOptions]="{standalone: true}" name="employee_name" placeholder="" [disabled]="true" ngModel/>                  
                            </div>
                            <div class="form-group col-sm-6">
                             <label  for="text-input">Client Name:</label>               
                             <input type="text" class="form-control" #client_name="ngModel" [(ngModel)]="selected_client_name"
                               [ngModelOptions]="{standalone: true}" name="client_name" placeholder="" [disabled]="true" ngModel/>         
                            </div>
                           </div>
                           <div class="form-group row">
                            <label class="col-md-3 col-form-label" for="text-input">Contact :</label>
                             <div class="col-md-3">
                             <input type="text" class="form-control" #country_code="ngModel" [(ngModel)]="selected_dial_code"
                               [ngModelOptions]="{standalone: true}" name="country_code" placeholder="" [disabled]="true" ngModel/>                      
                             </div>                                            
                             <div class="col-md-6">
                             <input type="text" class="form-control" #mobile_number="ngModel" [(ngModel)]="selected_mobile"
                               [ngModelOptions]="{standalone: true}" name="mobile_number" placeholder="" [disabled]="true" ngModel/>                    
                             </div>
                          </div>              
                          <div *ngFor="let detail of DetailsBookingList" >    
                          <strong>Room Detail</strong>
                            <div class="form-group row">
                              <label class="col-md-3 col-form-label" for="text-input">Room Number:</label>
                              <div class="col-md-9">
                              <input type="text" class="form-control" #room_number="ngModel" [(ngModel)]="selected_room_number"
                                [ngModelOptions]="{standalone: true}" name="room_number" placeholder="{{detail.title}}"  [disabled]="true" ngModel/>  
                              </div>
                            </div>                         
                            <div class="form-group row">
                              <label class="col-md-3 col-form-label" for="text-input">Check in date & time</label>
                              <div class="col-md-9">
                              <input type="text" class="form-control" #checkin="ngModel" [(ngModel)]="selected_checkin"
                                [ngModelOptions]="{standalone: true}" name="checkin" placeholder="{{detail.start}}" [disabled]="true" ngModel/>                  
                              </div>
                            </div>
                            <div class="form-group row">
                              <label class="col-md-3 col-form-label" for="text-input">Check out date & time</label>
                              <div class="col-md-9">
                              <input type="text" class="form-control" #checkout="ngModel" [(ngModel)]="selected_checkout"
                                [ngModelOptions]="{standalone: true}" name="checkout" placeholder="{{detail.end}}" [disabled]="true" ngModel/>                  
                              </div>
                            </div>
                            <div class="form-group row">
                              <label class="col-md-3 col-form-label" for="text-input">Price</label>
                              <div class="col-md-9">
                              <input type="text" class="form-control" #price="ngModel" [(ngModel)]="selected_reservation_time"
                                [ngModelOptions]="{standalone: true}" name="price" placeholder="{{detail.price}}" [disabled]="true" ngModel/>                  
                              </div>
                            </div>
                            <div>
                              <strong>Total: </strong>
                              <div class="form-group">
                                <input type="text" #total="ngModel" [(ngModel)]="total_detail_price" id="nf-client-price" name="total_price" class="form-control" [disabled]="true" ngModel>
                              </div>
                            </div> 
                            <div>
                            <label>Checked Out? </label> 
                              <div class="form-group">
                              <label class="switch switch-label switch-primary">
                                <input type="checkbox" class="switch-input" [checked]="selected_check_checkedout" [disabled]="selected_check_checkedout"
                                  (click)="toggleClickedCheckOut(detail.id)">
                                <span class="switch-slider" data-checked="Yes" data-unchecked="NO"></span>
                              </label>
                            </div>
                            </div> 
                            <div>
                              <label>Cancelled? </label> 
                                <div class="form-group">
                                <label class="switch switch-label switch-primary">
                                  <input type="checkbox" class="switch-input" [checked]="selected_check_cancelled" [disabled]="selected_check_cancelled" 
                                    (click)="toggleClickedCancel(detail.id,reasonValue)">
                                  <span class="switch-slider" data-checked="Yes" data-unchecked="NO"></span>
                                </label>
                              </div>
                            </div>
                            <div  *ngIf="show">
                              <label>Reason for cancel? </label> 
                                <div class="form-group">
                                <label class="col-md-9">
                                  <input type="text" class="form-control" name="reason" [(ngModel)]="selected_add_reason" placeholder="Enter a reson for cancelling..." ngModel/>                  
                                </label>
                                <button type="button" (click)="cancelReason(detail.id)" class="btn btn-block btn-primary">Cancel Booking</button>
                              </div>
                            </div>
                          </div>     
                    </div>
                    <div class="card-footer">
                    <!-- <div class="col-4">
                    <button type="button" (click)="showCancelMde()" class="btn btn-block btn-primary">Cancel Booking</button>
                    </div> -->
                    </div>
                  </div>                  
                 </div>
                </div>
              </div>
            </div>
            <!--end model-->

            <div bsModal #largeModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h4 class="modal-title">Add Bookings</h4>       
                    <button type="button" class="close" (click)="close()" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <!--Form starts here-->
                      <form (ngSubmit)="processForm()" [formGroup]="detailsForm" >
                          <!-- Nav tabs -->
                          <tabset>
                            <tab>
                              <ng-template tabHeading>Room reservation info</ng-template>
                              <!--Reservation Details-->                 
                              <div formArrayName="details">
                                <div *ngFor="let detail of details().controls; let empIndex=index">
                                  <div [formGroupName]="empIndex">
                                    <div [collapse]="isCollapsed">
                                    <div class="card"> 
                                      <button type="button" title="Remove"class="btn btn-sm btn-primary" (click)="removeDetail(empIndex)" >Remove Room</button>
                                      <br>
                                        <div class="col-7">                                                        
                                              <label for="nf-room">Room Number</label>
                                              <select required  formControlName="room" name="room" (ngModelChange)="selected($event,empIndex)" class="form-control" required>
                                                <option value="">Please select</option>
                                                <option *ngFor="let roomy of roomList"  [value]="roomy.id"  >{{roomy.room_number}} ~ Rs.{{roomy.price}} ~ {{roomy.category}}</option>
                                              </select>
                                              <span class="text-danger" *ngIf="getContactsFormGroup(empIndex).controls['room'].touched && getContactsFormGroup(empIndex).controls['room'].hasError('required')">
                                                Room  is required! </span>
                                        </div>
                                        <div class="col-7">
                                              <label >Price</label>
                                              <input type="number"  formControlName="price" (change)='getRoomID()' name="price" class="form-control"  placeholder="Enter a new price.." required>
                                              <span class="text-danger" *ngIf="getContactsFormGroup(empIndex).controls['price'].touched && getContactsFormGroup(empIndex).controls['price'].hasError('required')">
                                                Price  is required! </span>
                                        </div>
                                        <div class="col-7">
                                              <label>Check-in time</label>
                                              <input type="datetime-local" formControlName="checkin"  (change)='getCheckInTIme(empIndex)' name="checkin" class="form-control" placeholder="Enter check in time.."  required >
                                              <span class="text-danger" *ngIf="getContactsFormGroup(empIndex).controls['checkin'].touched && getContactsFormGroup(empIndex).controls['checkin'].hasError('required')">
                                                Check in  is required! </span>
                                          </div>
                                          <div class="col-7">
                                              <label >Check-out time</label>
                                              <input type="datetime-local" formControlName="checkout"  (change)='getCheckOutTIme(empIndex)'   name="checkout" class="form-control"   required >   
                                              <span class="text-danger" *ngIf="getContactsFormGroup(empIndex).controls['checkout'].touched && getContactsFormGroup(empIndex).controls['checkout'].hasError('required')">
                                                Check out  is required! </span>
                                          </div>
                                          <br>
                                          <div class="col-7">
                                            <label for="nf-client-nic">Meals</label>
                                            <div class="form-row">
                                                <div class="col">
                                                  <input type="checkbox">Breakfast
                                                </div>
                                                <div class="col">
                                                  <input type="checkbox">Lunch
                                                </div>
                                                <div class="col">
                                                  <input type="checkbox">Dinner
                                                </div>
                                                <div class="col">
                                                 <input type="checkbox">Tea
                                                </div>
                                            </div>
                                          </div>
                                          <br>
                                          <div  class="col-12">
                                            <div class="form-row">
                                              <div class="col">
                                                <label for="nf-client-nic">Number of adults </label>
                                                <input type="text" formControlName="adults"  name="adults" class="form-control" placeholder="Enter number of adults" required >
                                                <!-- <span class="help-block">Please enter your email</span> -->
                                              </div>
                                              <div class="col">
                                                <label for="nf-email"> Number of children </label>
                                                <input type="text" formControlName="children"  name="children" class="form-control" placeholder="Enter number of children.." required >
                                                <!-- <span class="help-block">Please enter your email</span> -->
                                              </div>
                                           </div>
                                        </div>
                                          <div *ngIf="clicked">
                                          <!-- <div  *ngIf="showEvents"> -->
                                            <div class="padding">
                                            <full-calendar
                                                  formControlName="calendar" 
                                                  name="calendar"
                                                  defaultView="dayGridMonth"
                                                  [header]="{
                                                    left: 'prev,next today',
                                                    center: 'title',
                                                    right: 'dayGridMonth,resourceTimelineDay,resourceTimelineWeek,listWeek'
                                                  }"
                                                  [plugins]     ="calendarPlugins"
                                                  [weekends]    ="calendarWeekends"
                                                  [events]      ="roomCalendarEvents[empIndex]"
                                                  schedulerLicenseKey="GPL-My-Project-Is-Open-Source"
                                                  [resourceColumns]  ="resourcecolumns"
                                                  [resources]   ="resourcelist"
                                                  selectable    ="true"
                                                  selectHelper  ="true"
                                                  navLinks      ="true"
                                                  editable      ="true"                                             
                                            ></full-calendar>
                                              <!-- </div>           -->
                                          </div>
                                        </div>                                  
                                          <!--Loa-->
                                          <div *ngIf="formloader">
                                            <div colspan="6" class="text-center padding-top">
                                              <div>
                                                <div class="lds-spinner margin-top">
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                  <div></div>
                                                </div>
                                              </div>
                                            </div>
                                          </div> 
                                    </div><!--Card div--> 
                                </div>   
                                <!-- <button type="button" class="btn btn-primary"(click)="collaps(empIndex)">Toggle collapse
                                 </button>              -->
                                </div>        
                                </div>
                              </div><!--Div formArrayName="details"-->
                              <label>If you need to add extra rooms please press the button below <strong>:</strong></label>
                              <button type="button" title="Add"class="btn btn-sm btn-primary" (click)="addDetail()">Add More Rooms</button>
                            </tab>
                            <tab>   
                              <ng-template tabHeading>Client Information</ng-template>                 
                              <div class="form-group row">
                                <div class="col-7">
                                  <div class="form-group">
                                    <label >Full name </label>
                                    <input type="text" formControlName="client_name" name="client_name" class="form-control" placeholder="Enter name.." required >
                                    <!-- <span class="help-block">Please enter your email</span> -->
                                  </div>
                                </div>
                              </div>
                                <div class="form-group row">
                                <div class="col-7">
                                  <label >Phone Number</label>
                                    <div class="form-group">
                                    <ngx-intl-tel-input
                                      [inputId]="'adsasd'"
                                      [cssClass]="'custom'" 
                                      [preferredCountries]="preferredCountries"
                                      [enableAutoCountrySelect]="false" 
                                      [enablePlaceholder]="true" 
                                      [searchCountryFlag]="true"
                                      [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"
                                      [selectFirstCountry]="false" 
                                      [selectedCountryISO]="CountryISO.SriLanka"
                                      [maxLength]="15" 
                                      [tooltipField]="TooltipLabel.Name" 
                                      [phoneValidation]="true" 
                                      [separateDialCode]="separateDialCode"
                                      formControlName="phone"
                                      name="phone" required >
                                    </ngx-intl-tel-input>
                                  </div>
                                </div>
                              </div>
                              <div class="form-group row">
                                <div class="col-7">
                                  <div class="form-group">
                                    <label for="nf-client-nic">Nic</label>
                                    <input type="text" formControlName="nic"  name="nic" class="form-control" placeholder="Enter nic.." required >
                                    <!-- <span class="help-block">Please enter your email</span> -->
                                  </div>
                                </div>
                              </div>
                            
                              <div class="form-group row">
                                <div class="col-6">
                                  <div class="form-group">
                                    <label for="nf-email">Email </label>
                                    <input type="email" formControlName="email"  name="email" class="form-control" placeholder="Enter Email.." required >
                                    <!-- <span class="help-block">Please enter your email</span> -->
                                  </div>
                                </div>
                              </div>     
                             
                              <div class="form-group row">
                                <div class="col-6">
                                  <div class="form-group">
                                    <label for="nf-client-nic">Channel</label>
                                    <select required  formControlName="channel" name="channel" class="form-control" required>
                                      <option value="">Please select Channel</option>
                                      <!-- <option *ngFor="let roomy of roomList"  [value]="roomy.id"  >{{roomy.room_number}} ~ Rs.{{roomy.price}} ~ {{roomy.category}}</option> -->
                                    </select>                           
                                  </div>
                                </div>
                               </div>                    
                            </tab>
                             <tab  (selectTab)="getTotal()">
                              <ng-template tabHeading>Total</ng-template>
                              <strong>Total: </strong>
                             <div class="col-7">
                              <input type="text" formControlName="total" name="total" class="form-control" readonly>
                             </div>
                              <div class="col-7">
                                <label for="nf-client-nic">Payment Method</label>
                                    <select required  formControlName="channel" name="channel" class="form-control" required>
                                      <option value="">Please select Channel</option>
                                      <!-- <option *ngFor="let roomy of roomList"  [value]="roomy.id"  >{{roomy.room_number}} ~ Rs.{{roomy.price}} ~ {{roomy.category}}</option> -->
                                    </select>  
                              </div>
                             <div class="col-7">
                             <label for="nf-client-nic">Amount Paid</label>
                             <input type="text" class="form-control" placeholder="Enter Amount   paid.." required >
                             <!-- <span class="help-block">Please enter your email</span> -->
                            </div>
                            <div class="card-footer">
                              <button type="submit" class="btn btn-sm btn-primary" [disabled]="!detailsForm.valid"  ><i class="fa fa-dot-circle-o"></i> Submit</button>
                              <button type="reset" class="btn btn-sm btn-danger"><i class="fa fa-ban"></i> Reset</button>
                            </div>   
                             </tab>
                              <div *ngIf="is_loading">
                                <div colspan="6" class="text-center padding-top">
                                  <div>
                                    <div class="lds-spinner margin-top">
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                      <div></div>
                                    </div>
                                  </div>
                                </div>
                              </div>  
                          </tabset>
                        </form>
                    <!--Form ends here-->
                  </div>             
                </div><!-- /.modal-content -->
              </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            <!--Next-->

                        
            <!--Cancel booking Model-->
            <!-- <div bsModal #activeModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
            aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <form>
                    <div class="modal-header">
                      <h4 class="modal-title">Change Activation</h4>
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                        (click)="cancel()">&times;</button>
                    </div>
                    <div class="modal-body">
                      <p>Are you sure you want to cancel the booking? </p>
                    </div>
                    <div class="modal-footer">
                      <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel" (click)="cancel()">
                      <input type="submit" class="btn btn-info"  value="Save" (click)="cancelBooking($event)">
                    </div>
                  </form>
                </div>
              </div>
            </div>category activity -->

        <!--Cancel booking Model-->
        <div bsModal #checkoutModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <form>
                <div class="modal-header">
                  <h4 class="modal-title">Checkout </h4>
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                    (click)="cancel()">&times;</button>
                </div>
                <div class="modal-body">
                  <p>Are you sure you want to checkout? Hoping to see you soon!!</p>
                </div>
                <div class="modal-footer">
                  <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel" (click)="cancel()">
                  <input type="submit" class="btn btn-info"  value="Save" (click)="checkoutBooking($event)">
                </div>
              </form>
            </div>
          </div>
        </div>
        <!--category activity -->
          </div>
        </div>
      </div>
    </div>
    <!-- The Modal
    <div class="modal" id="myModal" [style.display]="showModal ? 'block' : 'none'">
      <div class="modal-dialog">
        <div class="modal-content">
        
        
          <div class="modal-header">
            <h4 class="modal-title">{{ name }}</h4>
            <button type="button" class="close" data-dismiss="modal" (click) = "hide()">&times;</button>
          </div>
          
          Modal body 
          <div class="modal-body">
            Event Start From : {{ date }}
          </div>
          
          Modal footer 
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click) = "hide()">Close</button>
          </div>
          
        </div>
    </div> -->
  

  </body>
</html>
